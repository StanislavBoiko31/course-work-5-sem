{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Stanislav\\\\Desktop\\\\new project\\\\frontend\\\\src\\\\pages\\\\ProfilePage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport axiosInstance from \"../axiosInstance\";\nimport { useNavigate } from \"react-router-dom\";\nimport OrdersTable from \"../components/OrdersTable\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProfilePage = ({\n  onLogout\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [editing, setEditing] = useState(false);\n  const [form, setForm] = useState({});\n  const [orders, setOrders] = useState([]);\n  const [profileImage, setProfileImage] = useState(null);\n  const [discount, setDiscount] = useState(5); // дефолтна знижка\n  const [editOrderId, setEditOrderId] = useState(null);\n  const [editOrderForm, setEditOrderForm] = useState({});\n  const [services, setServices] = useState([]);\n  const [photographers, setPhotographers] = useState([]);\n  const [allPhotographers, setAllPhotographers] = useState([]); // всі фотографи\n  const [editOrderSlots, setEditOrderSlots] = useState([]);\n  const [editOrderLoadingSlots, setEditOrderLoadingSlots] = useState(false);\n  const [nextOrdersUrl, setNextOrdersUrl] = useState(null);\n  const [ordersLoading, setOrdersLoading] = useState(false);\n  const [additionalServices, setAdditionalServices] = useState([]);\n  const navigate = useNavigate();\n  const fetchOrders = async (url = \"/api/bookings/my/\") => {\n    setOrdersLoading(true);\n    try {\n      const res = await axiosInstance.get(url);\n      const data = res.data;\n      setOrders(prev => url === \"/api/bookings/my/\" ? data.results || data || [] : [...prev, ...(data.results || data || [])]);\n      setNextOrdersUrl(data.next || null);\n    } catch (err) {\n      setOrders([]);\n    } finally {\n      setOrdersLoading(false);\n    }\n  };\n  useEffect(() => {\n    // Завантаження профілю\n    const fetchUser = async () => {\n      try {\n        const res = await axiosInstance.get(\"/api/auth/users/myprofile/\");\n        setUser(res.data);\n        setForm({\n          first_name: res.data.first_name || \"\",\n          last_name: res.data.last_name || \"\",\n          email: res.data.email || \"\",\n          password: \"\"\n        });\n        setDiscount(res.data.personal_discount || 5);\n        setProfileImage(res.data.profile_image || null);\n      } catch (err) {\n        if (err.response && err.response.status === 401) {\n          navigate(\"/login\");\n        }\n      }\n    };\n    fetchUser();\n\n    // Завантаження історії замовлень\n    fetchOrders();\n\n    // Завантаження послуг і фотографів для редагування бронювання\n    const fetchServicesPhotographers = async () => {\n      try {\n        const [servicesRes, photographersRes, additionalServicesRes] = await Promise.all([axiosInstance.get(\"/api/services/\"), axiosInstance.get(\"/api/photographers/\"), axiosInstance.get(\"/api/additional-services/\")]);\n        setServices(servicesRes.data.results || servicesRes.data);\n        const photographersData = photographersRes.data.results || photographersRes.data;\n        setAllPhotographers(photographersData);\n        setPhotographers(photographersData);\n        setAdditionalServices(additionalServicesRes.data.results || additionalServicesRes.data);\n      } catch (e) {}\n    };\n    fetchServicesPhotographers();\n  }, [navigate]);\n\n  // Фільтрація фотографів при зміні послуги у формі редагування\n  useEffect(() => {\n    if (editOrderId) {\n      if (editOrderForm.service_id) {\n        const filteredPhotographers = allPhotographers.filter(ph => Array.isArray(ph.services) && ph.services.some(s => String(s.id) === String(editOrderForm.service_id)));\n        setPhotographers(filteredPhotographers);\n        if (editOrderForm.photographer_id && !filteredPhotographers.find(ph => ph.id === Number(editOrderForm.photographer_id))) {\n          setEditOrderForm(prev => ({\n            ...prev,\n            photographer_id: \"\",\n            start_time: \"\"\n          }));\n        }\n      } else {\n        setPhotographers(allPhotographers);\n      }\n    }\n  }, [editOrderForm.service_id, editOrderForm.photographer_id, allPhotographers, editOrderId]);\n\n  // Підвантаження слотів при зміні service/photographer/date у формі редагування\n  useEffect(() => {\n    if (editOrderId && editOrderForm.service_id && editOrderForm.photographer_id && editOrderForm.date) {\n      const fetchSlots = async () => {\n        try {\n          setEditOrderLoadingSlots(true);\n          console.log(\"Запит слотів:\", {\n            service: editOrderForm.service_id,\n            photographer: editOrderForm.photographer_id,\n            date: editOrderForm.date\n          });\n          const response = await axiosInstance.get(\"/api/bookings/available_slots/\", {\n            params: {\n              service: editOrderForm.service_id,\n              photographer: editOrderForm.photographer_id,\n              date: editOrderForm.date\n            }\n          });\n          setEditOrderSlots(response.data.slots || []);\n          setEditOrderForm(prev => ({\n            ...prev,\n            start_time: \"\"\n          }));\n        } catch (error) {\n          setEditOrderSlots([]);\n        } finally {\n          setEditOrderLoadingSlots(false);\n        }\n      };\n      fetchSlots();\n    } else if (editOrderId) {\n      setEditOrderSlots([]);\n      setEditOrderForm(prev => ({\n        ...prev,\n        start_time: \"\"\n      }));\n    }\n  }, [editOrderForm.service_id, editOrderForm.photographer_id, editOrderForm.date, editOrderId]);\n  const handleChange = e => setForm({\n    ...form,\n    [e.target.name]: e.target.value\n  });\n  const handleEdit = () => setEditing(true);\n  const handleSave = async e => {\n    e.preventDefault();\n    console.log(\"handleSave called\");\n    try {\n      let dataToSend;\n      let config = {};\n      if (profileImage && typeof profileImage !== \"string\") {\n        // Якщо вибрано нове фото\n        dataToSend = new FormData();\n        dataToSend.append(\"first_name\", form.first_name);\n        dataToSend.append(\"last_name\", form.last_name);\n        dataToSend.append(\"email\", form.email);\n        if (form.password) dataToSend.append(\"password\", form.password);\n        dataToSend.append(\"profile_image\", profileImage);\n        config.headers = {\n          \"Content-Type\": \"multipart/form-data\"\n        };\n      } else {\n        // Якщо фото не змінювали\n        dataToSend = {\n          ...form\n        };\n        if (!form.password) delete dataToSend.password;\n      }\n      const res = await axiosInstance.patch(\"/api/auth/users/me/\", dataToSend, config);\n      setEditing(false);\n      // Оновити дані без reload:\n      setUser(res.data);\n      setForm({\n        first_name: res.data.first_name || \"\",\n        last_name: res.data.last_name || \"\",\n        email: res.data.email || \"\",\n        password: \"\"\n      });\n      setDiscount(res.data.personal_discount || 5);\n      setProfileImage(res.data.profile_image || null);\n    } catch (err) {\n      var _err$response, _err$response$data, _err$response2;\n      alert(\"Помилка збереження профілю: \" + (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || err.message));\n      console.log(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.data) || err);\n    }\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    if (file) setProfileImage(file);\n  };\n  const handleLogout = () => {\n    localStorage.removeItem(\"access\");\n    localStorage.removeItem(\"refresh\");\n    if (onLogout) onLogout();\n    navigate(\"/login\");\n  };\n  const handleEditOrder = order => {\n    var _order$service, _order$photographer;\n    setEditOrderId(order.id);\n    const currentAdditionalServiceIds = order.additional_services_data ? order.additional_services_data.map(ads => ads.id) : [];\n    setEditOrderForm({\n      service_id: ((_order$service = order.service) === null || _order$service === void 0 ? void 0 : _order$service.id) || \"\",\n      photographer_id: ((_order$photographer = order.photographer) === null || _order$photographer === void 0 ? void 0 : _order$photographer.id) || \"\",\n      date: order.date || \"\",\n      start_time: order.start_time || \"\",\n      additional_service_ids: currentAdditionalServiceIds\n    });\n  };\n  const handleEditOrderChange = e => {\n    if (e.target.type === 'checkbox' && e.target.name === 'additional_service') {\n      const serviceId = Number(e.target.value);\n      const currentIds = editOrderForm.additional_service_ids || [];\n      if (e.target.checked) {\n        setEditOrderForm({\n          ...editOrderForm,\n          additional_service_ids: [...currentIds, serviceId]\n        });\n      } else {\n        setEditOrderForm({\n          ...editOrderForm,\n          additional_service_ids: currentIds.filter(id => id !== serviceId)\n        });\n      }\n    } else {\n      setEditOrderForm({\n        ...editOrderForm,\n        [e.target.name]: e.target.value\n      });\n    }\n  };\n  const handleEditOrderSave = async e => {\n    e.preventDefault();\n    try {\n      // Фільтруємо порожні значення перед відправкою\n      const dataToSend = {};\n      Object.keys(editOrderForm).forEach(key => {\n        const value = editOrderForm[key];\n        // Для additional_service_ids завжди відправляємо масив (навіть порожній), щоб можна було видалити всі послуги\n        if (key === 'additional_service_ids') {\n          dataToSend[key] = Array.isArray(value) ? value : [];\n        }\n        // Пропускаємо порожні рядки, але залишаємо 0, false, null та інші масиви\n        else if (value !== \"\" && value !== null && value !== undefined) {\n          if (Array.isArray(value) && value.length > 0) {\n            dataToSend[key] = value;\n          } else if (!Array.isArray(value)) {\n            dataToSend[key] = value;\n          }\n        }\n      });\n      await axiosInstance.patch(`/api/bookings/${editOrderId}/`, dataToSend);\n      setEditOrderId(null);\n      setOrders([]);\n      setNextOrdersUrl(null);\n      await fetchOrders(\"/api/bookings/my/\");\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      alert(\"Помилка збереження замовлення: \" + (((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.detail) || err.message || \"Невідома помилка\"));\n    }\n  };\n  const handleEditOrderCancel = () => {\n    setEditOrderId(null);\n  };\n  const handleCancelOrder = async orderId => {\n    if (!window.confirm(\"Ви дійсно хочете скасувати це замовлення?\")) return;\n    try {\n      await axiosInstance.patch(`/api/bookings/${orderId}/`, {\n        status: \"Скасовано користувачем\"\n      });\n      setOrders([]);\n      setNextOrdersUrl(null);\n      await fetchOrders(\"/api/bookings/my/\");\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      alert(\"Помилка скасування: \" + (((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.detail) || err.message));\n    }\n  };\n  if (!user) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 257,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 1100,\n      margin: \"40px auto\",\n      border: \"1px solid #ccc\",\n      padding: 32,\n      borderRadius: 8\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        alignItems: \"flex-start\",\n        gap: 32\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            display: \"inline-block\"\n          },\n          children: \"\\u041E\\u0441\\u043E\\u0431\\u0438\\u0441\\u0442\\u0430 \\u0456\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0456\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginLeft: 16\n          },\n          onClick: handleEdit,\n          children: \"\\u0417\\u043C\\u0456\\u043D\\u0438\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginLeft: 16,\n            background: '#f44',\n            color: '#fff'\n          },\n          onClick: handleLogout,\n          children: \"\\u0412\\u0438\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSave,\n          style: {\n            marginTop: 16\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"first_name\",\n            placeholder: \"\\u0406\\u043C'\\u044F\",\n            value: form.first_name,\n            onChange: handleChange,\n            disabled: !editing,\n            style: {\n              display: \"block\",\n              marginBottom: 8,\n              width: \"100%\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"last_name\",\n            placeholder: \"\\u0424\\u0430\\u043C\\u0456\\u043B\\u0456\\u044F\",\n            value: form.last_name,\n            onChange: handleChange,\n            disabled: !editing,\n            style: {\n              display: \"block\",\n              marginBottom: 8,\n              width: \"100%\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"email\",\n            placeholder: \"\\u041F\\u043E\\u0448\\u0442\\u0430\",\n            value: form.email,\n            onChange: handleChange,\n            disabled: !editing,\n            style: {\n              display: \"block\",\n              marginBottom: 8,\n              width: \"100%\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"password\",\n            type: \"password\",\n            placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n            value: form.password,\n            onChange: handleChange,\n            disabled: !editing,\n            style: {\n              display: \"block\",\n              marginBottom: 8,\n              width: \"100%\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this), editing && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"\\u0417\\u0431\\u0435\\u0440\\u0435\\u0433\\u0442\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: 8\n          },\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: profileImage ? typeof profileImage === \"string\" ? profileImage // якщо це URL з бекенду\n            : URL.createObjectURL(profileImage) // якщо це File\n            : \"/default-avatar.png\",\n            alt: \"profile\",\n            style: {\n              width: 120,\n              height: 120,\n              borderRadius: \"50%\",\n              objectFit: \"cover\",\n              border: \"1px solid #aaa\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: handleImageChange,\n          style: {\n            marginBottom: 8\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 16,\n            fontWeight: \"bold\"\n          },\n          children: [\"\\u0417\\u043D\\u0438\\u0436\\u043A\\u0430 \\u043D\\u0430 \\u043D\\u0430\\u0441\\u0442\\u0443\\u043F\\u043D\\u0435 \\u0437\\u0430\\u043C\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u044F: \", discount, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        marginTop: 40\n      },\n      children: \"\\u0406\\u0441\\u0442\\u043E\\u0440\\u0456\\u044F \\u0437\\u0430\\u043C\\u043E\\u0432\\u043B\\u0435\\u043D\\u044C \\u0444\\u043E\\u0442\\u043E\\u0441\\u0435\\u0441\\u0456\\u0439\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OrdersTable, {\n      orders: orders,\n      services: services,\n      photographers: photographers,\n      additionalServices: additionalServices,\n      editOrderId: editOrderId,\n      editOrderForm: editOrderForm,\n      editOrderSlots: editOrderSlots,\n      editOrderLoadingSlots: editOrderLoadingSlots,\n      onEdit: handleEditOrder,\n      onEditChange: handleEditOrderChange,\n      onEditSave: handleEditOrderSave,\n      onEditCancel: handleEditOrderCancel,\n      onCancelOrder: handleCancelOrder\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 7\n    }, this), nextOrdersUrl && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => fetchOrders(nextOrdersUrl),\n      style: {\n        marginTop: 16\n      },\n      disabled: ordersLoading,\n      children: ordersLoading ? \"Завантаження...\" : \"Показати ще\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 5\n  }, this);\n};\n_s(ProfilePage, \"7W0sCudch/KTAGpCkTZhP6QOBK0=\", false, function () {\n  return [useNavigate];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useEffect","useState","axiosInstance","useNavigate","OrdersTable","jsxDEV","_jsxDEV","ProfilePage","onLogout","_s","user","setUser","editing","setEditing","form","setForm","orders","setOrders","profileImage","setProfileImage","discount","setDiscount","editOrderId","setEditOrderId","editOrderForm","setEditOrderForm","services","setServices","photographers","setPhotographers","allPhotographers","setAllPhotographers","editOrderSlots","setEditOrderSlots","editOrderLoadingSlots","setEditOrderLoadingSlots","nextOrdersUrl","setNextOrdersUrl","ordersLoading","setOrdersLoading","additionalServices","setAdditionalServices","navigate","fetchOrders","url","res","get","data","prev","results","next","err","fetchUser","first_name","last_name","email","password","personal_discount","profile_image","response","status","fetchServicesPhotographers","servicesRes","photographersRes","additionalServicesRes","Promise","all","photographersData","e","service_id","filteredPhotographers","filter","ph","Array","isArray","some","s","String","id","photographer_id","find","Number","start_time","date","fetchSlots","console","log","service","photographer","params","slots","error","handleChange","target","name","value","handleEdit","handleSave","preventDefault","dataToSend","config","FormData","append","headers","patch","_err$response","_err$response$data","_err$response2","alert","detail","message","handleImageChange","file","files","handleLogout","localStorage","removeItem","handleEditOrder","order","_order$service","_order$photographer","currentAdditionalServiceIds","additional_services_data","map","ads","additional_service_ids","handleEditOrderChange","type","serviceId","currentIds","checked","handleEditOrderSave","Object","keys","forEach","key","undefined","length","_err$response3","_err$response3$data","handleEditOrderCancel","handleCancelOrder","orderId","window","confirm","_err$response4","_err$response4$data","children","fileName","_jsxFileName","lineNumber","columnNumber","style","maxWidth","margin","border","padding","borderRadius","display","alignItems","gap","flex","marginLeft","onClick","background","color","onSubmit","marginTop","placeholder","onChange","disabled","marginBottom","width","textAlign","src","URL","createObjectURL","alt","height","objectFit","accept","fontWeight","onEdit","onEditChange","onEditSave","onEditCancel","onCancelOrder","_c","$RefreshReg$"],"sources":["C:/Users/Stanislav/Desktop/new project/frontend/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axiosInstance from \"../axiosInstance\";\nimport { useNavigate } from \"react-router-dom\";\nimport OrdersTable from \"../components/OrdersTable\";\n\nconst ProfilePage = ({ onLogout }) => {\n  const [user, setUser] = useState(null);\n  const [editing, setEditing] = useState(false);\n  const [form, setForm] = useState({});\n  const [orders, setOrders] = useState([]);\n  const [profileImage, setProfileImage] = useState(null);\n  const [discount, setDiscount] = useState(5); // дефолтна знижка\n  const [editOrderId, setEditOrderId] = useState(null);\n  const [editOrderForm, setEditOrderForm] = useState({});\n  const [services, setServices] = useState([]);\n  const [photographers, setPhotographers] = useState([]);\n  const [allPhotographers, setAllPhotographers] = useState([]); // всі фотографи\n  const [editOrderSlots, setEditOrderSlots] = useState([]);\n  const [editOrderLoadingSlots, setEditOrderLoadingSlots] = useState(false);\n  const [nextOrdersUrl, setNextOrdersUrl] = useState(null);\n  const [ordersLoading, setOrdersLoading] = useState(false);\n  const [additionalServices, setAdditionalServices] = useState([]);\n  const navigate = useNavigate();\n\n  const fetchOrders = async (url = \"/api/bookings/my/\") => {\n    setOrdersLoading(true);\n    try {\n      const res = await axiosInstance.get(url);\n      const data = res.data;\n      setOrders(prev => url === \"/api/bookings/my/\" ? (data.results || data || []) : [...prev, ...(data.results || data || [])]);\n      setNextOrdersUrl(data.next || null);\n    } catch (err) {\n      setOrders([]);\n    } finally {\n      setOrdersLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    // Завантаження профілю\n    const fetchUser = async () => {\n      try {\n        const res = await axiosInstance.get(\"/api/auth/users/myprofile/\");\n        setUser(res.data);\n        setForm({\n          first_name: res.data.first_name || \"\",\n          last_name: res.data.last_name || \"\",\n          email: res.data.email || \"\",\n          password: \"\",\n        });\n        setDiscount(res.data.personal_discount || 5);\n        setProfileImage(res.data.profile_image || null);\n      } catch (err) {\n        if (err.response && err.response.status === 401) {\n          navigate(\"/login\");\n        }\n      }\n    };\n    fetchUser();\n\n    // Завантаження історії замовлень\n    fetchOrders();\n\n    // Завантаження послуг і фотографів для редагування бронювання\n    const fetchServicesPhotographers = async () => {\n      try {\n        const [servicesRes, photographersRes, additionalServicesRes] = await Promise.all([\n          axiosInstance.get(\"/api/services/\"),\n          axiosInstance.get(\"/api/photographers/\"),\n          axiosInstance.get(\"/api/additional-services/\")\n        ]);\n        setServices(servicesRes.data.results || servicesRes.data);\n        const photographersData = photographersRes.data.results || photographersRes.data;\n        setAllPhotographers(photographersData);\n        setPhotographers(photographersData);\n        setAdditionalServices(additionalServicesRes.data.results || additionalServicesRes.data);\n      } catch (e) {}\n    };\n    fetchServicesPhotographers();\n  }, [navigate]);\n\n  // Фільтрація фотографів при зміні послуги у формі редагування\n  useEffect(() => {\n    if (editOrderId) {\n      if (editOrderForm.service_id) {\n        const filteredPhotographers = allPhotographers.filter(ph =>\n          Array.isArray(ph.services) && ph.services.some(s => String(s.id) === String(editOrderForm.service_id))\n        );\n        setPhotographers(filteredPhotographers);\n        if (editOrderForm.photographer_id && !filteredPhotographers.find(ph => ph.id === Number(editOrderForm.photographer_id))) {\n          setEditOrderForm(prev => ({ ...prev, photographer_id: \"\", start_time: \"\" }));\n        }\n      } else {\n        setPhotographers(allPhotographers);\n      }\n    }\n  }, [editOrderForm.service_id, editOrderForm.photographer_id, allPhotographers, editOrderId]);\n\n  // Підвантаження слотів при зміні service/photographer/date у формі редагування\n  useEffect(() => {\n    if (editOrderId && editOrderForm.service_id && editOrderForm.photographer_id && editOrderForm.date) {\n      const fetchSlots = async () => {\n        try {\n          setEditOrderLoadingSlots(true);\n          console.log(\"Запит слотів:\", {\n            service: editOrderForm.service_id,\n            photographer: editOrderForm.photographer_id,\n            date: editOrderForm.date\n          });\n          const response = await axiosInstance.get(\"/api/bookings/available_slots/\", {\n            params: {\n              service: editOrderForm.service_id,\n              photographer: editOrderForm.photographer_id,\n              date: editOrderForm.date\n            }\n          });\n          setEditOrderSlots(response.data.slots || []);\n          setEditOrderForm(prev => ({ ...prev, start_time: \"\" }));\n        } catch (error) {\n          setEditOrderSlots([]);\n        } finally {\n          setEditOrderLoadingSlots(false);\n        }\n      };\n      fetchSlots();\n    } else if (editOrderId) {\n      setEditOrderSlots([]);\n      setEditOrderForm(prev => ({ ...prev, start_time: \"\" }));\n    }\n  }, [editOrderForm.service_id, editOrderForm.photographer_id, editOrderForm.date, editOrderId]);\n\n  const handleChange = (e) => setForm({ ...form, [e.target.name]: e.target.value });\n\n  const handleEdit = () => setEditing(true);\n\n  const handleSave = async (e) => {\n    e.preventDefault();\n    console.log(\"handleSave called\");\n    try {\n      let dataToSend;\n      let config = {};\n      if (profileImage && typeof profileImage !== \"string\") {\n        // Якщо вибрано нове фото\n        dataToSend = new FormData();\n        dataToSend.append(\"first_name\", form.first_name);\n        dataToSend.append(\"last_name\", form.last_name);\n        dataToSend.append(\"email\", form.email);\n        if (form.password) dataToSend.append(\"password\", form.password);\n        dataToSend.append(\"profile_image\", profileImage);\n        config.headers = { \"Content-Type\": \"multipart/form-data\" };\n      } else {\n        // Якщо фото не змінювали\n        dataToSend = { ...form };\n        if (!form.password) delete dataToSend.password;\n      }\n      const res = await axiosInstance.patch(\"/api/auth/users/me/\", dataToSend, config);\n      setEditing(false);\n      // Оновити дані без reload:\n      setUser(res.data);\n      setForm({\n        first_name: res.data.first_name || \"\",\n        last_name: res.data.last_name || \"\",\n        email: res.data.email || \"\",\n        password: \"\",\n      });\n      setDiscount(res.data.personal_discount || 5);\n      setProfileImage(res.data.profile_image || null);\n    } catch (err) {\n      alert(\"Помилка збереження профілю: \" + (err.response?.data?.detail || err.message));\n      console.log(err.response?.data || err);\n    }\n  };\n\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n    if (file) setProfileImage(file);\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"access\");\n    localStorage.removeItem(\"refresh\");\n    if (onLogout) onLogout();\n    navigate(\"/login\");\n  };\n\n  const handleEditOrder = (order) => {\n    setEditOrderId(order.id);\n    const currentAdditionalServiceIds = order.additional_services_data \n      ? order.additional_services_data.map(ads => ads.id)\n      : [];\n    setEditOrderForm({\n      service_id: order.service?.id || \"\",\n      photographer_id: order.photographer?.id || \"\",\n      date: order.date || \"\",\n      start_time: order.start_time || \"\",\n      additional_service_ids: currentAdditionalServiceIds\n    });\n  };\n  const handleEditOrderChange = (e) => {\n    if (e.target.type === 'checkbox' && e.target.name === 'additional_service') {\n      const serviceId = Number(e.target.value);\n      const currentIds = editOrderForm.additional_service_ids || [];\n      if (e.target.checked) {\n        setEditOrderForm({ ...editOrderForm, additional_service_ids: [...currentIds, serviceId] });\n      } else {\n        setEditOrderForm({ ...editOrderForm, additional_service_ids: currentIds.filter(id => id !== serviceId) });\n      }\n    } else {\n      setEditOrderForm({ ...editOrderForm, [e.target.name]: e.target.value });\n    }\n  };\n  const handleEditOrderSave = async (e) => {\n    e.preventDefault();\n    try {\n      // Фільтруємо порожні значення перед відправкою\n      const dataToSend = {};\n      Object.keys(editOrderForm).forEach(key => {\n        const value = editOrderForm[key];\n        // Для additional_service_ids завжди відправляємо масив (навіть порожній), щоб можна було видалити всі послуги\n        if (key === 'additional_service_ids') {\n          dataToSend[key] = Array.isArray(value) ? value : [];\n        }\n        // Пропускаємо порожні рядки, але залишаємо 0, false, null та інші масиви\n        else if (value !== \"\" && value !== null && value !== undefined) {\n          if (Array.isArray(value) && value.length > 0) {\n            dataToSend[key] = value;\n          } else if (!Array.isArray(value)) {\n            dataToSend[key] = value;\n          }\n        }\n      });\n      await axiosInstance.patch(`/api/bookings/${editOrderId}/`, dataToSend);\n      setEditOrderId(null);\n      setOrders([]);\n      setNextOrdersUrl(null);\n      await fetchOrders(\"/api/bookings/my/\");\n    } catch (err) {\n      alert(\"Помилка збереження замовлення: \" + (err.response?.data?.detail || err.message || \"Невідома помилка\"));\n    }\n  };\n  const handleEditOrderCancel = () => {\n    setEditOrderId(null);\n  };\n\n  const handleCancelOrder = async (orderId) => {\n    if (!window.confirm(\"Ви дійсно хочете скасувати це замовлення?\")) return;\n    try {\n      await axiosInstance.patch(`/api/bookings/${orderId}/`, { status: \"Скасовано користувачем\" });\n      setOrders([]);\n      setNextOrdersUrl(null);\n      await fetchOrders(\"/api/bookings/my/\");\n    } catch (err) {\n      alert(\"Помилка скасування: \" + (err.response?.data?.detail || err.message));\n    }\n  };\n\n  if (!user) return <div>Завантаження...</div>;\n\n  return (\n    <div style={{ maxWidth: 1100, margin: \"40px auto\", border: \"1px solid #ccc\", padding: 32, borderRadius: 8 }}>\n      <div style={{ display: \"flex\", alignItems: \"flex-start\", gap: 32 }}>\n        {/* Ліва частина: особиста інформація */}\n        <div style={{ flex: 1 }}>\n          <h2 style={{ display: \"inline-block\" }}>Особиста інформація</h2>\n          <button style={{ marginLeft: 16 }} onClick={handleEdit}>Змінити</button>\n          <button style={{ marginLeft: 16, background: '#f44', color: '#fff' }} onClick={handleLogout}>Вийти</button>\n          <form onSubmit={handleSave} style={{ marginTop: 16 }}>\n            <input\n              name=\"first_name\"\n              placeholder=\"Ім'я\"\n              value={form.first_name}\n              onChange={handleChange}\n              disabled={!editing}\n              style={{ display: \"block\", marginBottom: 8, width: \"100%\" }}\n            />\n            <input\n              name=\"last_name\"\n              placeholder=\"Фамілія\"\n              value={form.last_name}\n              onChange={handleChange}\n              disabled={!editing}\n              style={{ display: \"block\", marginBottom: 8, width: \"100%\" }}\n            />\n            <input\n              name=\"email\"\n              placeholder=\"Пошта\"\n              value={form.email}\n              onChange={handleChange}\n              disabled={!editing}\n              style={{ display: \"block\", marginBottom: 8, width: \"100%\" }}\n            />\n            <input\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"Пароль\"\n              value={form.password}\n              onChange={handleChange}\n              disabled={!editing}\n              style={{ display: \"block\", marginBottom: 8, width: \"100%\" }}\n            />\n            {editing && <button type=\"submit\">Зберегти</button>}\n          </form>\n        </div>\n        {/* Права частина: фото і знижка */}\n        <div style={{ textAlign: \"center\" }}>\n          <div style={{ marginBottom: 8 }}>\n            <img\n              src={\n                profileImage\n                  ? typeof profileImage === \"string\"\n                    ? profileImage // якщо це URL з бекенду\n                    : URL.createObjectURL(profileImage) // якщо це File\n                  : \"/default-avatar.png\"\n              }\n              alt=\"profile\"\n              style={{ width: 120, height: 120, borderRadius: \"50%\", objectFit: \"cover\", border: \"1px solid #aaa\" }}\n            />\n          </div>\n          <input type=\"file\" accept=\"image/*\" onChange={handleImageChange} style={{ marginBottom: 8 }} />\n          <div style={{ marginTop: 16, fontWeight: \"bold\" }}>\n            Знижка на наступне замовлення: {discount}%\n          </div>\n        </div>\n      </div>\n      {/* Історія замовлень */}\n      <h3 style={{ marginTop: 40 }}>Історія замовлень фотосесій</h3>\n      <OrdersTable\n        orders={orders}\n        services={services}\n        photographers={photographers}\n        additionalServices={additionalServices}\n        editOrderId={editOrderId}\n        editOrderForm={editOrderForm}\n        editOrderSlots={editOrderSlots}\n        editOrderLoadingSlots={editOrderLoadingSlots}\n        onEdit={handleEditOrder}\n        onEditChange={handleEditOrderChange}\n        onEditSave={handleEditOrderSave}\n        onEditCancel={handleEditOrderCancel}\n        onCancelOrder={handleCancelOrder}\n      />\n      {nextOrdersUrl && (\n        <button onClick={() => fetchOrders(nextOrdersUrl)} style={{marginTop: 16}} disabled={ordersLoading}>\n          {ordersLoading ? \"Завантаження...\" : \"Показати ще\"}\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default ProfilePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}